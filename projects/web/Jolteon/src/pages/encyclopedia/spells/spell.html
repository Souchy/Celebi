<import from="../../../components/modal/modal"></import>
<import from="../strings/stringcomponent"></import>
<import from="../stats/spell/spellstats"></import>
<import from="../effects/modelSelector/effectModelSelector"></import>
<import from="../effects/effect"></import>


<!-- vignette root/creature -->
<template if.bind="isvignette && mode != 'search'">
  <button class="title btn-outline" click.trigger="clickSpell()">
    <stringcomponent uid.bind="model.nameId" editable.bind="!isvignette"></stringcomponent>
  </button>
  <button class="btn close" click.trigger="clickRemove()">x</button>
</template>

<!-- vignette search -->
<template if.bind="isvignette && mode == 'search'">
  <div class="add">+</div>
  <button class="title titleSearch btn-outline" click.trigger="clickSpell()">
    <stringcomponent uid.bind="model.nameId" editable.bind="!isvignette"></stringcomponent>
  </button>
</template>

<!-- not vignette, full spell ui -->
<template if.bind="!isvignette">
  <h3>Spell #${model.modelUid}</h3>
  <stringcomponent uid.bind="model.nameId" editable=true></stringcomponent>
  <stringcomponent uid.bind="model.descriptionId" editable=true></stringcomponent>

  <!-- costs + stats -->
  <div style="display: flex;">
    <div>
      <h5>Costs</h5>
      <table class="table-striped table-sm table-borderless table-responsive-sm">
        <tbody>
          <tr repeat.for="charac of Characteristics.resourcesSpellCosts">
            <td>${charac.baseName}</td>
            <td><input type="number" value.bind="model.costs[charac.id]" change.trigger="onChangeCost(charac.id)" placeholder="0" /></td>
            <!-- <td>${charac.baseName} ${charac.id} ${model.costs[charac.id] || 0}</td> -->
          </tr>
        </tbody>
      </table>
    </div>
    <div>
      <h5>Stats</h5>
      <spellstats baseuid.bind="model.stats"></spellstats>
    </div>
  </div>

  <!-- effects -->
  <div>
    <h5>Effects</h5>
    <button class="btn" data-bs-toggle="modal" data-bs-target="#effectModelModal">Add</button>
    <modal id="effectModelModal" header="Effect Type" close.bind=false footer.bind=false>
      <effect-model-selector onselectcallback.bind="e => addEffect(e)"></effect-model-selector>
    </modal>

    <div class="effectlist">
      <effect repeat.for="effectid of model.effectIds" uid.bind="effectid"></effect>
    </div>
  </div>


</template>
