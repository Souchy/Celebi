<import from="./properties/propertygrid"></import>
<import from="../../../components/modal/modal"></import>
<import from="./modelSelector/effectModelSelector"></import>
<import from="../zone/zone"></import>
<import from="./effectlist"></import>

<!-- drag.trigger="e => onDrag(e)"  -->
<div if.bind="model">

  <div class="effecttitle">
    <!-- title -->
    <div class="effecttitletitle clickable" data-bs-toggle="collapse" data-bs-target="#collapseEffectContent-${model.entityUid}">
      <h5 click.trigger="clickMinimize()">${modelName}</h5>
      <h5 click.trigger="clickMinimize()">(${model.effectIds.length})</h5>
      <h5 click.trigger="clickMinimize()">${model.entityUid}</h5>
    </div>
    <button class="btn btn-floating" click.trigger="clickCopy()"><i class="fa-regular fa-copy"></i></button>
    <button class="btn btn-floating" click.trigger="clickPaste()"><i class="fa-regular fa-clipboard"></i></button>
    <button class="btn btn-floating" click.trigger="clickMoveUp()"><i class="fa-solid fa-angle-up"></i></button>
    <button class="btn btn-floating" click.trigger="clickMoveDown()"><i class="fa-solid fa-angle-down"></i></button>
    <!-- delete & confirm -->
    <button class="btn btn-floating" data-bs-toggle="modal" data-bs-target="#removeEffectModal-${model.entityUid}"><i class="fa-solid fa-xmark"></i></button>
    <modal id="removeEffectModal-${model.entityUid}" header="Remove effect?" close.bind=false footer.bind=true callbackok.bind="() => clickRemove()">
      Confirm remove ${modelName}?
    </modal>

  </div>

  <!-- content -->
  <!--  if.bind="!minimized" -->
  <div class="collapse show" id="collapseEffectContent-${model.entityUid}" if.bind="model">

    <!-- properties section -->
    <div class="effectSection d-flex">
      <div class="eblock" style="margin-right: 15px;">

        <!-- click.trigger="clickMinimize()"  -->
        <h6 class="clickable" data-bs-toggle="collapse" data-bs-target="#collapseZone-${model.entityUid}">Zone</h6>
        <zone zone.bind="model.targetAcquisitionZone" uid.bind="model.entityUid" callbacksave.bind="() => onSave()"></zone>
      </div>

      <div style="margin-right: 15px;">
        <h6>Caster Condition</h6>
        <h6>Target Filter</h6>
      </div>
      <div style="margin-right: 15px;">
        <h6>Triggers</h6>
        <button class="btn btn-floating" click.trigger="clickAddTrigger()">+</button>
        <trigger repeat.for="trigger of model.triggers" model.bind="trigger" callbacksave.bind="() => onSave()"></trigger>
      </div>

      <div class="eblock" style="flex-grow: 1;">
        <h6>Schema</h6>
        <!-- change type -->
        <button class="btn btn-floating btn-changeSchema" data-bs-toggle="modal" data-bs-target="#effectSchemaTypeModal-${model.entityUid}">
          Change type
        </button>
        <modal id="effectSchemaTypeModal-${model.entityUid}" header="Change Schema Type" close.bind=false footer.bind=false>
          <effect-model-selector onselectcallback.bind="e => onChangeSchemaType(e)"></effect-model-selector>
        </modal>
        <!-- schema properties -->
        <propertygrid data.bind="model.schema" schema.bind="schema" uid.bind="model.entityUid" callbacksave.bind="() => onSave()"></propertygrid>
      </div>
    </div>

    <!-- children section -->
    <effectlist if.bind="model.effectIds" effectids.bind="model.effectIds" modaluid.bind="model.entityUid" callbacksave.bind="() => onSave()"></effectlist>

<!-- 
    <div class="effectSection">
      <h6 class="clickable" data-bs-toggle="collapse" data-bs-target="#collapseEffects-${model.entityUid}">
        Effects
      </h6>
      <button class="btn btn-floating" data-bs-toggle="modal" data-bs-target="#effectChildModal-${model.entityUid}">+</button>
      <button class="btn btn-floating" click.trigger="clickPasteNew()"><i class="fa-regular fa-clipboard"></i></button>

      <modal id="effectChildModal-${model.entityUid}" header="Add Effect Child" close.bind=false footer.bind=false>
        <effect-model-selector onselectcallback.bind="e => onAddChild(e)"></effect-model-selector>
      </modal>

      <div class="effectlist collapse show" id="collapseEffects-${model.entityUid}">
        <effect repeat.for="effectid of model.effectIds" uid.bind="effectid" callbackmoveup.bind="e => onMoveEffectUp(e)" callbackmovedown.bind="e => onMoveEffectDown(e)" callbackremove.bind="e => onRemoveEffect(e)"></effect>
      </div>
    </div> -->



  </div>

</div>

<!-- modelUid -->
<!-- model name -->
<!-- model desc -->
<!-- model BoardTargetType -->
<!-- model propertySchemaType => property names -->

<!-- zone -->
<!-- conditions target -->
<!-- conditions caster -->
<!-- triggers -->
