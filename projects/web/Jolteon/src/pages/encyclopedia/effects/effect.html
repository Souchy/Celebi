<import from="./properties/propertygrid"></import>
<import from="../../../components/modal/modal"></import>
<import from="./modelSelector/effectModelSelector"></import>
<import from="../zone/zone"></import>

<div if.bind="model">

  <div class="effecttitle">
    <!-- title -->
    <div class="effecttitletitle clickable"  data-bs-toggle="collapse" data-bs-target="#collapseEffectContent-${model.entityUid}">
      <h5 click.trigger="clickMinimize()">${getModelName()}</h5>
      <h5 click.trigger="clickMinimize()">(${model.effectIds.length})</h5>
      <h5 click.trigger="clickMinimize()">${model.entityUid}</h5>
    </div>
    <button class="btn btn-outline" click.trigger="clickMoveUp()">^</button>
    <button class="btn btn-outline" click.trigger="clickMoveDown()">v</button>
    <!-- delete & confirm -->
    <button class="btn btn-outline" data-bs-toggle="modal" data-bs-target="#removeEffectModal-${model.entityUid}">x</button>
    <modal id="removeEffectModal-${model.entityUid}" header="Remove effect?" close.bind=false footer.bind=true callbackok.bind="() => clickRemove()">
      Confirm remove ${getModelName()}?
    </modal>

  </div>

  <!-- content -->
  <!--  if.bind="!minimized" -->
  <div class="collapse show" id="collapseEffectContent-${model.entityUid}">

    <!-- properties section -->
    <div class="effectSection d-flex">
      <div class="eblock" style="margin-right: 15px;">
        <h6 class="clickable" data-bs-toggle="collapse" data-bs-target="#collapseZone-${model.entityUid}">
          <!-- click.trigger="clickMinimize()"  -->
          Zone
        </h6>
        <zone zone.bind="model.targetAcquisitionZone" uid.bind="model.entityUid" callbacksave.bind="() => onSave()"></zone>
      </div>

      <div style="margin-right: 15px;">
        <h6>Caster Condition</h6>
        <div>
          <h6>Target Filter</h6>
        </div>
      </div>

      <div class="eblock" style="flex-grow: 1;">
        <h6>Schema</h6>
        <propertygrid data.bind="model.schema" schema.bind="schema" uid.bind="model.entityUid" callbacksave.bind="() => onSave()"></propertygrid>
      </div>
    </div>

    <!-- children section -->
    <div class="effectSection">
      <h6 class="clickable" data-bs-toggle="collapse" data-bs-target="#collapseEffects-${model.entityUid}">
        Effects
      </h6>
      <button class="btn" data-bs-toggle="modal" data-bs-target="#effectChildModal-${model.entityUid}">+</button>
      <modal id="effectChildModal-${model.entityUid}" header="Add Effect Child" close.bind=false footer.bind=false>
        <effect-model-selector onselectcallback.bind="e => onAddChild(e)"></effect-model-selector>
      </modal>

      <div class="effectlist collapse show" id="collapseEffects-${model.entityUid}">
        <effect repeat.for="effectid of model.effectIds" uid.bind="effectid" callbackmoveup.bind="e => onMoveEffectUp(e)" callbackmovedown.bind="e => onMoveEffectDown(e)" callbackremove.bind="e => onRemoveEffect(e)"></effect>
      </div>
    </div>



  </div>

</div>

<!-- modelUid -->
<!-- model name -->
<!-- model desc -->
<!-- model BoardTargetType -->
<!-- model propertySchemaType => property names -->

<!-- zone -->
<!-- conditions target -->
<!-- conditions caster -->
<!-- triggers -->
